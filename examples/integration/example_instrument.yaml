name: 'Example Instrument'
description: 'A simulated instrument for testing purposes'
module: voxel.instrument
class: VoxelInstrument

daq:
  conn: Dev1
  simulated: True
  tasks:
    primary_ao_task:
      task_type: ao
      sampling_frequency_hz: 350000
      period_time_ms: 10
      rest_time_ms: 0

  # Define reusable waveform anchors
  default_waveforms:
    square_waveform: &default_square_waveform
      waveform_type: square
      center_volts: 2.5
      amplitude_volts: 2.5
      cutoff_freq_hz: 1000
      start_time_ms: 0
      end_time_ms: 5
    triangle_waveform: &default_triangle_waveform
      waveform_type: triangle
      center_volts: 2.5
      amplitude_volts: 2.5
      cutoff_freq_hz: 1000
      peak_point: 0.5
    sawtooth_waveform: &default_sawtooth_waveform
      <<: *default_triangle_waveform
      peak_point: 1

channels:
  red:
    camera: simulated_camera_1
    lens: objective_40x
    laser: laser_561
    filter: filter_561
    writer: imaris
    file_transfer: robocopy
  green:
    camera: simulated_camera_1
    lens: objective_40x
    laser: laser_488
    filter: filter_488
    writer: imaris
    file_transfer: robocopy

devices:
  simulated_camera_1:
    module: voxel.instrument.devices.camera.simulated
    class: SimulatedCamera
    kwds:
      serial_number: 12345
      pixel_size_um: 3.5, 3.5
    daq_channel:
      task: primary_ao_task
      port: ao0
      <<: *default_square_waveform
  objective_40x:
    module: voxel.instrument.devices.lens
    class: VoxelLens
    kwds:
      magnification: 40
  laser_488:
    module: voxel.instrument.devices.laser.simulated
    class: SimulatedLaser
    kwds:
      wavelength: 488
    daq_channel:
      task: primary_ao_task
      port: ao1
      <<: *default_triangle_waveform
  laser_561:
    module: voxel.instrument.devices.laser.simulated
    class: SimulatedLaser
    kwds:
      wavelength: 561
    daq_channel:
      task: primary_ao_task
      port: ao2
      <<: *default_sawtooth_waveform
  filter_488:
    module: voxel.instrument.devices.filter.simulated
    class: SimulatedFilter
    kwds:
      wheel: filterwheel
      position: 1
  filter_561:
    module: voxel.instrument.devices.filter.simulated
    class: SimulatedFilter
    kwds:
      wheel: filterwheel
      position: 2
  x-axis:
    module: voxel.instrument.devices.linear_axis.simulated
    class: SimulatedLinearAxis
    kwds:
      dimension: X
    daq_channel:
      task: primary_ao_task
      port: ao3
      <<: *default_square_waveform
  y-axis:
    module: voxel.instrument.devices.linear_axis.simulated
    class: SimulatedLinearAxis
    kwds:
      dimension: Y
  z-axis:
    module: voxel.instrument.devices.linear_axis.simulated
    class: SimulatedLinearAxis
    kwds:
      dimension: Z
  filterwheel:
    module: voxel.instrument.devices.filter.simulated
    class: SimulatedFilterWheel
    kwds:
      wheel_id: 1

writers:
  imaris:
    module: voxel.instrument.writers.imaris
    class: ImarisWriter
    kwds:
      path: E:\\

transfers:
  robocopy:
    module: voxel.instrument.file_transfers.robocopy
    class: RobocopyFileTransfer
    kwds:
      external_path: Z:\\scratch\\adam.glaser
      local_path: E:\\

settings:
  simulated_camera_1:
    exposure_time_ms: 20.0
    pixel_type: 16
    roi_height_px: 512
    roi_width_px: 512
    bit_packing_mode: msb

settings_other: # Figure out how to merge this with settings
  imaris:
    compression: lz4shuffle
    data_type: uint16
  robocopy:
    verify_transfer: True
    max_retry: 3
    timeout_s: 60