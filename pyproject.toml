[project]
name = "voxel"
description = "Python Library for building SPIM software"
authors = [
    { name = "Micah Woodard", email = "micah.woodard@alleninstitute.org" },
    { name = "Adam Glaser", email = "adam.glaser@alleninstitute.org" },
    { name = "Walter Mwaniki", email = "walter.mwaniki@alleninstitute.org" },
]
readme = "README.md"
license = { file = "LICENSE" }
requires-python = ">=3.12"
classifiers = [
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "License :: OSI Approved :: MIT License",
    "Operating System :: OS Independent",
]
keywords = ["microscopy", "light-sheet", "lightsheet", "microscope", "imaging"]
version = "0.1.0"
dependencies = [
    # core
    "numpy>=2.1.2",
    "matplotlib>=3.9.2",
    "pydantic>=2.9.2",
    "ruamel-yaml >= 0.18.5",
    # hardware
    "nidaqmx>=1.0.1",
    "pyserial >= 3.5",
    "PyVISA-py >= 0.7.2",
    "tigerasi >= 0.0.26",
    "pylablib-lightweight>=1.4.3",
    # files
    "imohash>=1.1.0",
    "tifffile>=2024.9.20",
    # processing
    "gputools >= 0.2.14",
    "fast-histogram >= 0.14",
    # utils
    "sympy >= 1.12.1",
    "ome-types>=0.5.3",
    "jax>=0.4.35",
    "tensorstore>=0.1.68",
    "torch>=2.4.1",
    "psutil>=6.1.0",
    "pyclesperanto>=0.16.0",
    "scikit-image>=0.24.0",
    "zerorpc>=0.6.3",
    "opencv-python>=4.11.0.86",
    "msgpack-numpy>=0.4.8",
    "rpyc>=6.0.2",
    "tabulate>=0.9.0",
    "colorama>=0.4.6",
    "msgpack>=1.1.0",
    "zmq>=0.0.0",
    "plumbum>=1.9.0",
    "scipy>=1.14.1",
    "mako>=1.3.7",
    "plotly>=6.2.0",
]

[project.optional-dependencies]
aaopto = ["aaopto-aotf>=0.0.11"]
cobolt = ["pycobolt"]
coherent = ["coherent-lasers"]
vortran = ["vortran-laser"]
oxxius = ["oxxius-laser"]
obis = ["obis-laser"]
bdv = ["h5py>=3.12.1", "tqdm>=4.66.5"]
imaris = ["pyimariswriter>=0.7.0"]
etl-opto = ["optoicc", "optokummenberg"]
egrabber = ["egrabber"]
all = [
    "voxel[aaopto, cobolt, coherent, vortran, oxxius, obis, bdv, imaris, etl-opto, egrabber]",
]

[dependency-groups]
dev = ["ruff>=0.8.0", "uvicorn>=0.34.0"]

[tool.uv.sources]
pycobolt = { git = "https://github.com/cobolt-lasers/pycobolt.git" }
coherent-lasers = { git = "https://github.com/AllenNeuralDynamics/coherent_lasers.git" }
obis-laser = { git = "https://github.com/AllenNeuralDynamics/obis-laser.git" }
oxxius-laser = { git = "https://github.com/AllenNeuralDynamics/oxxius_laser.git" }
vortran-laser = { git = "https://github.com/AllenNeuralDynamics/vortran_laser.git" }
optokummenberg = { path = ".wheels/optoKummenberg-1.0.4894-py3-none-any.whl" }
optoicc = { path = ".wheels/optoICC-2.0.4922-py3-none-any.whl" }
egrabber = { path = ".wheels/egrabber-24.09.0.5-py2.py3-none-any.whl" }

[project.scripts]
voxel-mock = "voxel.startup:launch_mock"
voxel-remote = "voxel.startup.remote:main"

[build-system]
requires = ["uv_build>=0.8.2,<0.9.0"]
build-backend = "uv_build"


[tool.ruff]
line-length = 120
show-fixes = true

target-version = "py311"

exclude = [
    ".bzr",
    ".direnv",
    ".eggs",
    ".git",
    ".gitignore",
    ".git-rewrite",
    ".hg",
    ".ipynb_checkpoints",
    ".mypy_cache",
    ".nox",
    ".pants.d",
    ".pyenv",
    ".pytest_cache",
    ".pytype",
    ".ruff_cache",
    ".svn",
    ".tox",
    ".venv",
    ".vscode",
    "__pypackages__",
    "_build",
    "buck-out",
    "build",
    "dist",
    "node_modules",
    "site-packages",
    "venv",
    "sdk",
]

lint.extend-select = ["C4", "SIM", "TC"]
fixable = ["ALL"]


[tool.tach]
source_roots = ["**/src"]
exclude = ["**/sdk/"]
external.rename = [
    "ruamel:ruamel_yaml",
    "serial:pyserial",
    "pylablib:pylablib_lightweight",
    "pyvisa:pyvisa_py",
    "cv2:opencv_python",
    "skimage:scikit_image",
    "PyImarisWriter:pyimariswriter",
]
