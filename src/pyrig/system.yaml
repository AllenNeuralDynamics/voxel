_anchors:
  - &camera_ip "127.0.0.1"
  - &laser_target pyrig.drivers.laser.Laser
  - &camera_target pyrig.drivers.camera.Camera

metadata:
  name: "LightSheetMicroscope_01"
  control_port: 9000 # Controller ROUTER socket port

nodes:
  primary:
    devices:
      laser_488:
        target: *laser_target
        kwargs: { wavelength: 488 }
      laser_561:
        target: *laser_target
        kwargs: { wavelength: 561 }
  node_1:
    hostname: *camera_ip
    devices:
      camera_1:
        target: *camera_target
        kwargs: { pixel_size_um: "0.5, 0.5" }
  node_2:
    hostname: *camera_ip
    devices:
      camera_2:
        target: *camera_target
        kwargs: { pixel_size_um: "0.5, 0.5" }
# Architecture:
# - Controller starts ROUTER socket on control_port (single port for all nodes)
# - Controller spawns local node subprocesses
# - All nodes (local and remote) connect to controller:control_port using DEALER sockets
# - Nodes set their ZMQ identity to node_id
# - Nodes request config via "provision" action
# - Controller sends NodeConfig to each node
# - Nodes create devices and allocate ports automatically
# - Nodes respond with device addresses via "provision_complete" action
# - Controller creates DeviceClients and waits for heartbeats
